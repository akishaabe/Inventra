<div class="reports-container">
  <!-- Sidebar -->
  <aside class="sidebar" [class.open]="sidebarOpen">
    <div class="sidebar-header">
      <h2 class="logo">inventra</h2>
      <button class="close-btn" (click)="toggleSidebar()">â˜°</button>
    </div>
    <nav class="nav-links">
      <a routerLink="/dashboard" routerLinkActive="active">Dashboard</a>
      <a routerLink="/inventory" routerLinkActive="active">Inventory</a>
      <a routerLink="/forecasting" routerLinkActive="active">Forecasting</a>
      <a routerLink="/reports" routerLinkActive="active">Reports</a>
      <a routerLink="/settings" routerLinkActive="active">Settings</a>
      <a (click)="logout()">Logout</a>
    </nav>
  </aside>

  <!-- Header -->
  <header class="reports-header">
    <div class="header-left">
      <button class="menu-btn" (click)="toggleSidebar()" *ngIf="!sidebarOpen">â˜°</button>
      <h2 class="brand-name" *ngIf="!sidebarOpen">inventra</h2>
    </div>

    <div class="header-right">
      <span class="user-name">CafÃ© PÃ¨dro</span>
      <img src="assets/images/profile icon.png" alt="Profile" class="profile-icon"   (click)="goToSettings()"
  style="cursor: pointer;"/>
    </div>
  </header>

  <!-- Main Content -->
  <main class="reports-main">
    <h1 class="reports-title">Reports</h1>

    <div class="reports-buttons">
      <button [class.active]="activeTab === 'sales'" (click)="setActiveTab('sales')">Sales</button>
      <button [class.active]="activeTab === 'inventory'" (click)="setActiveTab('inventory')">Inventory</button>
      <button [class.active]="activeTab === 'forecasting'" (click)="setActiveTab('forecasting')">Forecasting</button>
    </div>

    <section *ngIf="activeTab === 'sales'" class="reports-section">
      <h2>Sales Report</h2>
      <table class="reports-table">
        <thead>
          <tr>
            <th>Product</th>
            <th>Units Sold</th>
            <th>Revenue (â‚±)</th>
            <th>Percentage of Total</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of reportData">
            <td>{{ item.product_name }}</td>
            <td>{{ item.units_sold }}</td>
            <td>{{ item.revenue | number: '1.2-2' }}</td>
            <td>{{ item.percentage }}%</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section *ngIf="activeTab === 'inventory'" class="reports-section">
      <h2>Inventory Summary</h2>
      <table class="reports-table">
        <thead>
          <tr>
            <th>Item</th>
            <th>Stock</th>
            <th>Reorder Level</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of inventoryData">
            <td>{{ item.item_name }}</td>
            <td>{{ item.stock }}</td>
            <td>{{ item.reorder_level }}</td>
            <td [ngClass]="{ 'low-stock': item.stock < item.reorder_level }">
              {{ item.stock < item.reorder_level ? 'Low' : 'Sufficient' }}
            </td>
          </tr>
        </tbody>
      </table>
    </section>

<!-- Forecasting section (replace in your existing HTML) -->
<section *ngIf="activeTab === 'forecasting'" class="reports-section">
  <div class="forecast-header">
    <h2>Forecasting Overview</h2>
    <div class="forecast-controls">
      <select [(ngModel)]="selectedHorizon" (change)="fetchForecastData()">
        <option value="7">Next 7 Days</option>
        <option value="14">Next 14 Days</option>
        <option value="30">Next 30 Days</option>
        <option value="60">Next 60 Days</option>
        <option value="90">Next 90 Days</option>
      </select>
      <button class="print-btn" (click)="printReport()">ðŸ–¨ Print Report</button>
    </div>
  </div>

  <div class="forecast-chart">
    <canvas id="forecastChart"></canvas>
  </div>

  <div class="forecast-table-container">
    <table class="reports-table">
      <thead>
        <tr>
          <th>Product</th>
          <th>Date</th>
          <th>Forecasted Demand</th>
          <th>Available Qty</th>
        </tr>
      </thead>
      <tbody>
        <!-- The backend returns one row per product (latest forecast). Render accordingly -->
        <tr *ngFor="let f of forecastData">
          <td>{{ f.product_name }}</td>
          <td>{{ f.forecast_date | date:'yyyy-MM-dd' }}</td>
          <td>{{ f.forecasted_demand }}</td>
          <td>{{ f.quantity_available }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="ai-recommendations" *ngIf="aiRecommendations && aiRecommendations.length">
    <h3>AI Recommendations</h3>
    <ul>
      <li *ngFor="let rec of aiRecommendations">
        <strong>{{ rec.priority | titlecase }}:</strong> {{ rec.text }}
        <div *ngIf="rec.reason" style="font-size:0.9rem;color:#666">{{ rec.reason }}</div>
      </li>
    </ul>
  </div>
</section>


  </main>
</div>
